'use strict';

// Create upper listener instance to file input element
var upper = Upper({ debug: true }),
    uploader = upper.listen(window.document.getElementById('fileUpload'))

// get callback with preview url
.on('preview', function (url) {
    window.document.getElementById('preview').setAttribute('src', url);
})

// get notified of upload progress
.on('progress', function (progress) {
    console.log(JSON.stringify(progress, null, 4));
});

// event on completed image upload
// - you can pass back data from the server here
// This is useful for passing back data like save location etc
.on('completed', function (passedBackData) {
    console.log('Upper completed, extra data from the server: ' + passedBackData);
});

// no transport
var upper = Upper({ transport: null });

// middleware for uploading
.on('chunk', function (chunk, done) {

    // upload chunk however you like, deal with it
    // using your own server side implementation
    http.post('/upload', chunk).then(function () {

        // call done when we can move onto
        // the next chunk
        done();
    });
});
