/* jshint undef: false */
/* jshint strict: false */

/**
 * @function constructInstance
 * @desc Uses equivalent of `.apply(this, arguments)` for constructing
 *       new objects
 * @reference http://stackoverflow.com/questions/1606797/use-of-apply-with-new-operator-is-this-possible
 */
function constructInstance (Obj) {

    function F (args) {
        return Obj.apply(this, args);
    }
    F.prototype = Obj.prototype;

    return function () {
        return new F(arguments);
    };
}

/* Returns new object instance if AMD is used, or assigns it to window.Upper */
return (function () {
    if (typeof window.define === 'function' && window.define.amd) {
        window.define([], function () {
            return constructInstance(Upper);
        });
    } else {
        if(!window.Upper) {
            window.Upper = constructInstance(Upper);
        }
        return Upper;
    }
})();
